\documentclass[10pt]{article}
\usepackage{xcolor}
\usepackage{setspace}
\usepackage{graphicx}
\usepackage{pagecolor}
\usepackage{geometry}
\usepackage[hidelinks]{hyperref}
\usepackage{fancyhdr}
\usepackage{titlesec}
\usepackage{sectsty}
\usepackage{caption}
\usepackage{float}
\usepackage{longtable}
\usepackage{array}
\usepackage{titling}

% Define exact background color from your image
\definecolor{exactbg}{RGB}{18,18,19}
\definecolor{brand}{RGB}{18,129,200}
\definecolor{muted}{RGB}{100,100,100}

% Page layout
\geometry{
  a4paper,
  left=22mm,
  right=22mm,
  top=20mm,
  bottom=20mm
}

% Header/footer
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0.4pt}
\newcommand{\sectiontitle}{}
\renewcommand{\sectionmark}[1]{\renewcommand{\sectiontitle}{#1}}
\fancyhead[L]{\textbf{\MakeUppercase{\sectiontitle}}}
\fancyfoot[C]{\thepage}

% Section style
\allsectionsfont{\normalfont\scshape\bfseries}
\titleformat{\section}{\Large\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}{\normalsize\bfseries}{\thesubsection}{0.5em}{}

% Document title meta (used on title page)
\newcommand{\ReportTitle}{Vulnerability Test Report}
\newcommand{\CompanyName}{InLighn Tech}
\newcommand{\CompanyTagline}{Experience, Learn, Thrive}
\newcommand{\ReportSubtitle}{Docker Image Vulnerability Analysis}

% Reduce paragraph spacing
\setlength{\parskip}{0.6em}
\setlength{\parindent}{0pt}

% Title page (full-bleed background)
\begin{document}
\pagenumbering{gobble} % suppress page numbers on title
\newgeometry{margin=0in}
\begin{titlepage}
\pagecolor{exactbg}
\color{white}
\vspace*{2.8cm}

\begin{center}
  {\Huge \textbf{\ReportTitle} \par}
  \vspace{0.6cm}
  {\large \ReportSubtitle \par}
  \vspace{1.4cm}
  {\Huge \textbf{\CompanyName}\par}
  \vspace{0.4cm}
  {\Large \CompanyTagline \par}
  \vspace{2cm}

  % Big hero image (if provided)
  \begin{minipage}{0.85\textwidth}
    \centering
    \includegraphics[width=0.85\textwidth]{assets/a.png}
  \end{minipage}

  \vfill

  % Social icons row (images should exist in assets/)
  \begin{center}
    \href{https://github.com/ADITYADAS1999}{\includegraphics[width=1.4cm]{assets/3291667.png}} \hspace{0.5cm}
    \href{https://twitter.com/ADITYA90546170}{\includegraphics[width=1.4cm]{assets/images.png}} \hspace{0.5cm}
    \href{https://www.linkedin.com/in/aditya-das-7b2276202}{\includegraphics[width=1.4cm]{assets/linkin.png}} \hspace{0.5cm}
    \href{mailto:adityamca123@gmail.com}{\includegraphics[width=1.4cm]{assets/mail.png}} \hspace{0.5cm}
    \href{https://www.youtube.com/}{\includegraphics[width=1.4cm]{assets/yiutube.jpg}}
  \end{center}

  \vspace{1cm}
  \small \textit{Generated on: \today}
\end{center}

\thispagestyle{empty}
\end{titlepage}
\restoregeometry
\pagecolor{white}
\color{black}
\clearpage

% Table of Contents
\pagestyle{plain}
\pagenumbering{roman}
\tableofcontents
\clearpage
\pagenumbering{arabic}
\pagestyle{fancy}

% Executive summary section
\section*{Executive Summary}
\addcontentsline{toc}{section}{Executive Summary}
\label{sec:summary}
\noindent
\textbf{Target:} \texttt{my-custom-app:latest} \\
\textbf{Scanner:} Trivy (JSON) \\

\vspace{6pt}
\noindent
\textbf{Summary:} This report summarizes the vulnerability scan results for the Docker image. It highlights the number and severity of findings and provides a detailed listing of each vulnerable package and recommended action.

\bigskip

% Severity distribution chart & quick counts
\section*{Severity Distribution}
\addcontentsline{toc}{section}{Severity Distribution}
\begin{center}
  \includegraphics[width=0.6\textwidth]{assets/severity_chart.png}
\end{center}

\bigskip

% Include a small summary box generated by the script (report_content.tex should include \subsection*{Summary} with an itemize)
\input{report_content.tex}

% Vulnerability details - long table (script will fill a table else placeholder)
\section*{Vulnerability Details}
\label{sec:details}

% If the python generator wrote a table, it will be included in report_content.tex.
% Otherwise, provide a generic placeholder table to avoid compile errors.

\begin{longtable}{|p{4cm}|p{4cm}|p{2cm}|p{3cm}|p{2.5cm}|}
\hline
\textbf{Package} & \textbf{Vulnerability ID} & \textbf{Severity} & \textbf{Installed Version / Fixed Version} & \textbf{Location} \\
\hline
\endhead

% Example fallback row â€” real rows should be written by scripts/json_to_tex.py
\texttt{(auto-generated)} & \texttt{(auto-generated)} & \texttt{(auto)} & \texttt{(auto)} & \texttt{(auto)} \\
\hline
\end{longtable}

\bigskip

% Recommendations
\section*{Recommendations}
\begin{itemize}
  \item Prioritize \textbf{CRITICAL} and \textbf{HIGH} vulnerabilities for immediate remediation.
  \item Update/patch affected packages or switch to a base image with fewer known vulnerabilities.
  \item Rebuild and re-scan after fixes; implement automated scans in CI/CD.
  \item Consider using multi-stage builds and minimal base images to reduce surface area.
\end{itemize}

\bigskip

% Appendix
\section*{Appendix}
\subsection*{Scanner Raw Output}
\noindent The raw JSON output from the scanner is saved alongside this report as \texttt{report.json}.

\vspace{8pt}
\subsection*{Build / Scan Metadata}
\begin{itemize}
  \item Git commit: \texttt{(in CI insert commit hash)}
  \item Docker image tag: \texttt{my-custom-app:latest}
  \item Scan command: \texttt{trivy image --format json --output report.json my-custom-app:latest}
\end{itemize}

\vfill
\begin{center}
  \small This document was automatically generated by the Docker Vulnerability Report pipeline.
\end{center}

\end{document}
